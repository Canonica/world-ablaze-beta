on_actions = {
	on_startup = {
		effect = {
			every_country = {
				limit = {
					exists = yes
					check_variable = { num_core_states > 0 }
				}
				add_to_array = {
					global.starting_tags = THIS
				}
			}
		}
		effect = {
			every_country = {
				if = {
					limit = {
						NOT = {
							has_variable = ROOT.reserves
						}
					}
					set_variable = { ROOT.reserves = 0 }
				}
				country_event = { id = afo_event.1 }
				set_global_flag = world_ablaze
				if = {
					limit = {
						has_game_rule = {
							rule = allow_eastereggs
							option = EASTEREGGS_ALLOWED
						}
					}
					country_event = { id = afo_event.19 }
				}
			}
			every_country = {
				limit = {
					NOT = { is_in_faction_with = SOV }
				}
				reverse_add_opinion_modifier = {
					target = SOV
					modifier = isolated_economy
				}
			}
			every_country = {
				limit = {
					has_idea = League_of_nations
					NOT = { tag = ENG }
					NOT = { tag = FRA }
				}
				add_opinion_modifier = {
					target = FRA
					modifier = League_of_nations_opinion
				}
				add_opinion_modifier = {
					target = ENG
					modifier = League_of_nations_opinion
				}
			}
			#			every_country = {
			#				limit = {
			#					is_ai = yes
			#				}
			#				set_technology = {
			#					iron_bauxite_1 = 1
			#				}
			#				add_equipment_production = {
			#					equipment = {
			#						type = iron_bauxite_equipment_1
			#					}
			#					requested_factories = 1
			#					progress = 0.1
			#					efficiency = 10
			#				}
			#			}
			FRA = {
				add_opinion_modifier = {
					target = ENG
					modifier = League_of_nations_opinion
				}
			}
			ITA = {
				complete_national_focus = ITA_ethiopian_war_logistics
			}
			JAP = {
				set_autonomy = {
					target = MAN
					autonomous_state = autonomy_wtt_imperial_associate
					freedom_level = 0.4
				}
				set_autonomy = {
					target = MEN
					autonomous_state = autonomy_wtt_imperial_associate
					freedom_level = 0.4
				}
			}
			SOV = {
				complete_national_focus = SOV_start_the_second_five_year_plan
				add_equipment_to_stockpile = {
					type = tank_sov_light_chassis_1
					amount = 1943
					producer = SOV
				}
				add_equipment_to_stockpile = {
					type = tank_sov_medium_chassis_2
					amount = 750
					producer = SOV
				}
			}
			ENG = {
				add_opinion_modifier = {
					target = FRA
					modifier = League_of_nations_opinion
				}
			}
			every_state = {
				limit = {
					OR = {
						is_core_of = USA
					}
				}
				add_dynamic_modifier = { modifier = great_depression_state }
			}
			every_state = {
				limit = {
					OR = {
						is_core_of = MON
						is_core_of = CHI
						is_core_of = KOR
						is_core_of = PHI
						is_core_of = MAL
						is_core_of = INS
						is_core_of = NEP
						is_core_of = BHU
						is_core_of = TIB
						is_core_of = PAK
						is_core_of = RAJ
						is_core_of = PNG
						is_core_of = SRL
						is_core_of = SIA
						is_core_of = VIN
						is_core_of = CAM
						is_core_of = LAO
						is_core_of = PER
						is_core_of = IRQ
						is_core_of = SAU
						is_core_of = YEM
						is_core_of = OMA
						is_core_of = AFG
						is_core_of = MEX
						is_core_of = BRM
						is_core_of = PAL
						is_core_of = JOR
						is_on_continent = africa
						is_on_continent = south_america
						state = 721
						state = 658
						state = 765
						state = 656
						state = 453
						state = 680
					}
					# CHI
					NOT = { state = 613 }
					NOT = { state = 924 }
					NOT = { state = 598 }
					NOT = { state = 949 }
					NOT = { state = 608 }
					#
					NOT = { state = 446 }
					NOT = { state = 447 }
					NOT = { state = 923 }
					NOT = { state = 452 }
					NOT = { state = 451 }
					NOT = { state = 450 }
					NOT = { state = 448 }
					NOT = { state = 449 }
					NOT = { state = 458 }
					NOT = { state = 460 }
					NOT = { state = 459 }
					NOT = { state = 461 }
					NOT = { state = 663 }
					NOT = { state = 327 }
				}
				add_dynamic_modifier = { modifier = agrarian_state }
			}
			USA = {
				add_to_variable = { USA_pacific_control = 38 }
				add_to_variable = { JAP_pacific_control = 37 }
				add_to_variable = { ENG_pacific_control = 25 }
			}
			JAP = {
				add_to_variable = { USA_pacific_control = 38 }
				add_to_variable = { JAP_pacific_control = 37 }
				add_to_variable = { ENG_pacific_control = 25 }
			}
			ENG = {
				add_to_variable = { USA_pacific_control = 38 }
				add_to_variable = { JAP_pacific_control = 37 }
				add_to_variable = { ENG_pacific_control = 25 }
				add_to_variable = { ENG_med_control = 55 }
				add_to_variable = { ITA_med_control = 45 }
			}
			ITA = {
				add_to_variable = { ENG_med_control = 55 }
				add_to_variable = { ITA_med_control = 45 }
			}
		}
		effect = {
			#France faction set-up
			FRA = {
				set_country_flag = FRA_factions_unlocked
				set_variable = { var = FRA_National_bloc_attitude value = -2 }
				set_variable = { var = FRA_National_bloc_influence value = 3 }
				set_variable = { var = FRA_National_bloc_political_power_gain value = -5 }
				set_variable = { var = FRA_National_bloc_factory_output value = -3 }
				set_variable = { var = FRA_National_bloc_stability value = -3 }
				set_variable = { var = FRA_CGT_attitude value = -2 }
				set_variable = { var = FRA_CGT_influence value = 3 }
				set_variable = { var = FRA_CGT_factory_output value = -2 }
				set_variable = { var = FRA_CGT_political_power_gain value = -5 }
				set_variable = { var = FRA_CGT_stability value = -3 }
				set_variable = { var = FRA_Far_Right_Leagues_attitude value = -2 }
				set_variable = { var = FRA_Far_Right_Leagues_influence value = 1 }
				set_variable = { var = FRA_Far_Right_Leagues_political_power_gain value = -3 }
				set_variable = { var = FRA_far_right_leagues_war_support value = -2 }
				set_variable = { var = FRA_Far_Right_Leagues_stability value = 0 }
				set_variable = { var = FRA_French_Industrialists_attitude value = 2 }
				set_variable = { var = FRA_French_Industrialists_influence value = 5 }
				set_variable = { var = FRA_French_Industrialists_political_power_gain value = 2 }
				set_variable = { var = FRA_French_Industrialists_factory_output value = 0 }
				set_variable = { var = FRA_French_Industrialists_dockyard_output value = 0 }
				FRA_political_instability_update_effect = yes
				FRA_disjointed_government_level = yes
			}
			#Italy faction set-up
			ITA = {
				set_country_flag = ITA_factions_unlocked
				set_variable = { var = ITA_Bourgeoisie_attitude value = -2 }
				set_variable = { var = ITA_Bourgeoisie_influence value = 1 }
				set_variable = { var = ITA_Bourgeoisie_political_power_gain value = -1 }
				set_variable = { var = ITA_Bourgeoisie_stability value = -1 }
				set_variable = { var = ITA_Proletariat_attitude value = 1 }
				set_variable = { var = ITA_Proletariat_influence value = 4 }
				set_variable = { var = ITA_Proletariat_political_power_gain value = 0 }
				set_variable = { var = ITA_Proletariat_stability value = 1 }
				set_variable = { var = ITA_Vatican_attitude value = 0 }
				set_variable = { var = ITA_Vatican_influence value = 3 }
				set_variable = { var = ITA_Vatican_political_power_gain value = 0 }
				set_variable = { var = ITA_Vatican_stability value = 2 }
				set_variable = { var = ITA_pci_attitude value = -3 }
				set_variable = { var = ITA_pci_influence value = 1 }
				set_variable = { var = ITA_pci_political_power_gain value = -1 }
				set_variable = { var = ITA_pci_stability value = -1 }
				ITA_political_instability_update_effect = yes
			}
			#Japan faction set-up
			JAP = {
				set_country_flag = JAP_factions_unlocked
				set_variable = { var = JAP_Kantaiha_influence value = 3 }
				set_variable = { var = JAP_Kantaiha_construction_speed_military value = 0 }
				set_variable = { var = JAP_Kantaiha_construction_speed_dockyard value = 0 }
				set_variable = { var = JAP_Kantaiha_factory_output value = 0 }
				set_variable = { var = JAP_Kantaiha_dockyard_output value = 0 }
				set_variable = { var = JAP_Kantaiha_stability value = 0 }
				set_variable = { var = JAP_Toseiha_influence value = 3 }
				set_variable = { var = JAP_Toseiha_construction_speed_military value = 0 }
				set_variable = { var = JAP_Toseiha_construction_speed_dockyard value = 0 }
				set_variable = { var = JAP_Toseiha_factory_output value = 0 }
				set_variable = { var = JAP_Toseiha_dockyard_output value = 0 }
				set_variable = { var = JAP_Toseiha_stability value = 0 }
				set_variable = { var = JAP_Kodoha_influence value = 3 }
				set_variable = { var = JAP_Kodoha_construction_speed_military value = 0 }
				set_variable = { var = JAP_Kodoha_construction_speed_dockyard value = 0 }
				set_variable = { var = JAP_Kodoha_factory_output value = 0 }
				set_variable = { var = JAP_Kodoha_dockyard_output value = 0 }
				set_variable = { var = JAP_Kodoha_stability value = 0 }
				set_variable = { var = JAP_Zaibatsus_influence value = 5 }
				set_variable = { var = JAP_Zaibatsus_construction_speed_civilian value = -2 }
				set_variable = { var = JAP_Zaibatsus_consumer_goods value = 1 }
				set_variable = { var = JAP_Zaibatsus_political_power_gain value = -1 }
				JAP_political_instability_update_effect = yes
			}
			#Germany faction set-up
			GER = {
				set_country_flag = GER_factions_unlocked
				set_variable = { var = GER_Wehrmacht_attitude value = 15 }
				set_variable = { var = GER_SS_attitude value = 5 }
				set_variable = { var = GER_Industrialists_attitude value = 0 }
				set_variable = { var = GER_Public_Support_attitude value = 0 }
				set_variable = { var = GER_Wehrmacht_influence value = 35 }
				set_variable = { var = GER_SS_influence value = 5 }
				set_variable = { var = GER_Industrialists_influence value = 3 }
				set_variable = { var = GER_Public_Support_influence value = 1 }
				set_variable = { var = GER_Wehrmacht_political_power_gain value = 0 }
				set_variable = { var = GER_SS_political_power_gain value = 0 }
				set_variable = { var = GER_Industrialists_research_speed value = 0 }
				set_variable = { var = GER_Public_Support_war_support value = 0 }
				set_variable = { var = GER_Wehrmacht_stability value = 0 }
				set_variable = { var = GER_SS_stability value = 0 }
				set_variable = { var = GER_Industrialists_stability value = 0 }
				set_variable = { var = GER_Public_Support_stability value = 0 }
				GER_political_instability_update_effect = yes
			}
			#Soviet faction set-up
			SOV = {
				set_country_flag = SOV_factions_unlocked
				set_variable = { var = SOV_Commissars_attitude value = 1 }
				set_variable = { var = SOV_Army_attitude value = 0 }
				set_variable = { var = SOV_Workers_attitude value = 1 }
				set_variable = { var = SOV_Peasants_attitude value = -1 }
				set_variable = { var = SOV_Commissars_influence value = 3 }
				set_variable = { var = SOV_Army_influence value = 4 }
				set_variable = { var = SOV_Workers_influence value = 0 }
				set_variable = { var = SOV_Peasants_influence value = 0 }
				set_variable = { var = SOV_Commissars_political_power_gain value = -2 }
				set_variable = { var = SOV_Army_political_power_gain value = -2 }
				set_variable = { var = SOV_Army_research_speed value = 0 }
				set_variable = { var = SOV_Workers_factory_output value = 0 }
				set_variable = { var = SOV_Peasants_consumer_goods value = -1 }
				set_variable = { var = SOV_Commissars_stability value = 0 }
				set_variable = { var = SOV_Army_stability value = 0 }
				set_variable = { var = SOV_Workers_stability value = 1 }
				set_variable = { var = SOV_Peasants_stability value = -1 }
				SOV_political_instability_update_effect = yes
			}
			#UK faction set-up
			ENG = {
				set_country_flag = ENG_factions_unlocked
				set_variable = { var = ENG_Labour_attitude value = 1 }
				set_variable = { var = ENG_Conservative_attitude value = 1 }
				set_variable = { var = ENG_British_Royalists_attitude value = 0 }
				set_variable = { var = ENG_British_Radicalists_attitude value = 0 }
				set_variable = { var = ENG_Labour_influence value = 4 }
				set_variable = { var = ENG_Conservative_influence value = 4 }
				set_variable = { var = ENG_British_Royalists_influence value = 1 }
				set_variable = { var = ENG_British_Radicalists_influence value = 1 }
				set_variable = { var = ENG_Labour_political_power_gain value = 0 }
				set_variable = { var = ENG_Conservative_political_power_gain value = 0 }
				set_variable = { var = ENG_British_Royalists_political_power_gain value = 0 }
				set_variable = { var = ENG_British_Radicalists_political_power_gain value = 0 }
				set_variable = { var = ENG_Labour_stability value = 1 }
				set_variable = { var = ENG_Conservative_stability value = 1 }
				set_variable = { var = ENG_British_Royalists_stability value = 0 }
				set_variable = { var = ENG_British_Radicalists_stability value = 0 }
				ENG_political_instability_update_effect = yes
			}
			#USA faction set-up
			USA = {
				set_country_flag = USA_factions_unlocked
				set_variable = { USA_Kaiser_attitude = 1 }
				set_variable = { USA_Ford_Chrysler_attitude = -2 }
				set_variable = { USA_GM_Dupont_attitude = -2 }
				set_variable = { USA_JPMorgan_attitude = -2 }
				set_variable = { USA_Public_attitude = -4 }
				set_variable = { USA_Kaiser_influence = 2 }
				set_variable = { USA_Ford_Chrysler_influence = 4 }
				set_variable = { USA_GM_Dupont_influence = 4 }
				set_variable = { USA_JPMorgan_influence = 4 }
				set_variable = { USA_Public_influence = 5 }
			}
		}
		effect = {
			if = {
				limit = {
					FRA = { is_ai = no }
				}
				FRA = {
					load_oob = "FRA_1936_air_legacy_player"
					add_manpower = -40000
				}
			}
		}
		effect = {
			if = {
				limit = {
					FRA = { is_ai = yes }
				}
				FRA = {
					add_manpower = -40000
				}
			}
		}
		effect = {
			if = {
				limit = {
					ENG = { is_ai = no }
				}
				ENG = {
					load_oob = "ENG_1936_air_legacy_player"
					load_oob = "ENG_1936_Cavalry"
				}
			}
		}
		effect = {
			if = {
				limit = {
					GER = { is_ai = no }
				}
				GER = {
					load_oob = "GER_1936_air_legacy_player"
				}
			}
		}
		effect = {
			if = {
				limit = {
					ITA = { is_ai = no }
				}
				ITA = {
					load_oob = "ITA_1936_Cavalry"
				}
			}
		}
		effect = {
			if = {
				limit = {
					JAP = { is_ai = no }
				}
				JAP = {
					load_oob = "JAP_1936_Cavalry"
				}
			}
		}
		effect = {
			if = {
				limit = {
					GER = { is_ai = no }
				}
				GER = {
					load_oob = "GER_1936_Cavalry"
				}
			}
		}
		effect = {
			if = {
				limit = {
					SOV = { is_ai = no }
				}
				SOV = {
					set_technology = { sov_armoured_car_1 = 1 }
					set_technology = { sov_scout_car_1 = 1 }
					load_oob = "SOV_1936_Cavalry"
				}
			}
		}
		effect = {
			if = {
				limit = {
					USA = { is_ai = no }
				}
				USA = {
					load_oob = "USA_1936_Cavalry"
				}
			}
		}
		effect = {
			if = {
				limit = {
					is_historical_focus_on = yes
					POR = {
						is_ai = yes
					}
				}
				POR = {
					set_rule = { can_not_declare_war = yes }
				}
			}
		}
		effect = {
			if = {
				limit = {
					is_historical_focus_on = yes
					SOV = {
						is_ai = yes
					}
				}
				SOV = {
					set_rule = { can_send_volunteers = no }
				}
			}
		}
		effect = {
			if = {
				limit = {
					COS = {
						is_ai = yes
					}
				}
				COS = {
					set_rule = { can_join_factions = no }
				}
			}
		}
		effect = {
			if = {
				limit = {
					PRU = {
						is_ai = yes
					}
				}
				PRU = {
					set_rule = { can_join_factions = no }
				}
			}
		}
	}

	on_war = {
		effect = {
			if = {
				limit = {
					tag = SOV
					SOV = {
						has_global_flag = sov_yes_pact
						any_enemy_country = {
							NOT = { has_war_with = GER }
						}
						NOT = { has_country_flag = SOV_war_since_start }
					}
				}
				set_country_flag = SOV_war_since_start
			}
			if = {
				limit = {
					tag = SOV
					SOV = {
						NOT = { has_global_flag = sov_yes_pact }
						NOT = { has_country_flag = SOV_war_since_start }
					}
				}
				set_country_flag = SOV_war_since_start
			}
		}
		effect = {
			if = {
				limit = {
					tag = FIN
				}
				set_country_flag = FIN_war_since_start
			}
		}
		effect = {
			if = {
				limit = {
					tag = JAP
					has_war_with = CHI
				}
				set_country_flag = { flag = JAP_CHI_war_since_start days = 360 }
			}
		}
		effect = {
			if = {
				limit = {
					has_idea = League_of_nations
					OR = {
						AND = {
							has_war_With = ENG
							ENG = { has_idea = League_of_nations }
						}
						AND = {
							has_war_With = FRA
							FRA = { has_idea = League_of_nations }
						}
						AND = {
							has_war_With = FRA
							tag = ENG
						}
						AND = {
							has_war_With = ENG
							tag = FRA
						}
					}
				}
				remove_ideas = League_of_nations
			}
		}
		effect = {
			if = {
				limit = {
					GER = { has_war_with = POL }
					NOT = { SOV = { has_war_With = GER } }
					NOT = { SOV = { has_war_With = POL } }
					NOT = { has_global_flag = invade_poland_question }
					SOV = { has_global_flag = sov_yes_pact }
					SOV = { NOT = { has_global_flag = mr_honored } }
					SOV = { NOT = { has_global_flag = mr_not_honored } }
					OR = {
						POL = { controls_state = 96 }
						POL = { controls_state = 95 }
						POL = { controls_state = 97 }
						POL = { controls_state = 94 }
						POL = { controls_state = 93 }
						POL = { controls_state = 91 }
						POL = { controls_state = 89 }
					}
				}
				set_global_flag = invade_poland_question
				SOV = { country_event = { days = 14 id = sov_armor.819 } }
			}
		}
		effect = {
			if = {
				limit = {
					GER = { has_war_with = SWI }
					GER = { has_completed_focus = GER_swiss_franc_agreement }
				}
				activate_decision = POR_rip_up_the_swiss_franc_agreement
				GER = {
					remove_resource_rights = 180
					remove_ideas = swiss_franc_agreement_GER
				}
			}
		}
		effect = {
			if = {
				limit = {
					tag = USA
					has_completed_focus = USA_selective_service_act
				}
				if = {
					limit = {
						OR = {
							has_idea = disarmed_nation
							has_idea = volunteer_only
						}
					}
					add_ideas = USA_selective_service
				}
			}
		}
	}

	on_declare_war = {
		effect = {
			if = {
				limit = {
					FROM = {
						tag = USA
						has_country_flag = end_mobilization
					}
				}
				FROM = {
					clr_country_flag = end_mobilization
				}
			}
			else_if = {
				limit = {
					tag = USA
					has_country_flag = end_mobilization
				}
				clr_country_flag = end_mobilization
			}
			if = {
				limit = {
					tag = ENG
					is_ai = no
					any_enemy_country = {
						is_ai = no
					}
					NOT = { has_country_flag = ENG_colonies_annexed }
				}
				hidden_effect = {
					set_country_flag = ENG_colonies_annexed
				}
				annex_country = { target = UKO }
				annex_country = { target = UKE }
				annex_country = { target = UKN }
				annex_country = { target = UKT }
				annex_country = { target = UKM }
				add_equipment_to_stockpile = { type = eng_inf_1 amount = 11800 producer = ENG }
				add_equipment_to_stockpile = { type = support_equipment_1 amount = 700 producer = ENG }
			}
			if = {
				limit = {
					tag = ITA
					is_ai = no
					any_enemy_country = {
						is_ai = no
					}
					NOT = { has_country_flag = ITA_colonies_annexed }
				}
				hidden_effect = {
					set_country_flag = ITA_colonies_annexed
				}
				ITL = {
					every_unit_leader = {
						set_nationality = ITA
					}
				}
				annex_country = { target = ITL transfer_troops = yes }
				annex_country = { target = ITS transfer_troops = yes }
				add_equipment_to_stockpile = { type = ita_inf_0 amount = 1900 producer = ITL }
			}
		}
	}

	on_peace = {
		effect = {
			if = {
				limit = {
					OR = {
						ETH = { exists = no }
						NOT = { ETH = { has_war_with = ITA } }
					}
				}
				clr_global_flag = second_italo_ethiopian_war_flag
			}
		}
		effect = {
			if = {
				limit = {
					has_country_flag = FIN_war_since_start
				}
				set_country_flag = FIN_lessons_of_war_check_flag
				if = {
					limit = {
						has_template = "French Volunteers"
					}
					delete_unit_template_and_units = { division_template = "French Volunteers" disband = yes}
					FRA = {
						division_template = {
							name = "French Volunteers"
							is_locked = yes
							regiments = {
								mountaineers = { x = 0 y = 0}
								mountaineers = { x = 0 y = 1}
								mountaineers = { x = 0 y = 2}

								mountaineers = { x = 1 y = 0}
								mountaineers = { x = 1 y = 1}
								mountaineers = { x = 1 y = 2}

								mountaineers = { x = 2 y = 0}
								mountaineers = { x = 2 y = 1}
								mountaineers = { x = 2 y = 2}

								artillery_brigade = { x = 3 y = 0}
								artillery_brigade = { x = 3 y = 1}
								artillery_brigade = { x = 3 y = 2}
							}

							support = {
								horse_logistics_company = {x = 0 y = 0}
								engineer = {x = 0 y = 1}
								recon = {x = 1 y = 0}
								horse_field_hospital = {x = 1 y = 1}
								signal_company = {x = 0 y = 2}
							}
						}
						random_owned_state = {
							create_unit = {
								division = "name = \"Volunteers from Finland\" division_template = \"French Volunteers\" start_experience_factor = 1 start_equipment_factor = 1"
								owner = FRA
							}
						}
					}
				}
			}
		}
		effect = {
			if = {
				limit = {
					has_country_flag = SOV_war_since_start
				}
				set_country_flag = SOV_lessons_of_war_check_flag
			}
		}
	}

	on_capitulation = {
		effect = {
			if = {
				limit = {
					tag = ENG
				}
				ENG = {
					every_state = {
						limit = {
							has_state_flag = ENG_resource_rights_flag
							OR = {
								is_controlled_by = ROOT
								CONTROLLER = { is_subject_of = ROOT }
							}
						}
						PREV = { remove_resource_rights = PREV }
						clr_state_flag = ENG_resource_rights_flag
					}
				}
			}
			if = {
				limit = {
					tag = FRA
				}
				FRA = {
					every_state = {
						limit = {
							has_state_flag = FRA_resource_rights_flag
							OR = {
								is_controlled_by = ROOT
								CONTROLLER = { is_subject_of = ROOT }
							}
						}
						PREV = { remove_resource_rights = PREV }
						clr_state_flag = FRA_resource_rights_flag
					}
				}
			}
			if = {
				limit = {
					tag = BEL
				}
				BEL = {
					every_state = {
						limit = {
							has_state_flag = BEL_resource_rights_flag
							OR = {
								is_controlled_by = ROOT
								CONTROLLER = { is_subject_of = ROOT }
							}
						}
						PREV = { remove_resource_rights = PREV }
						clr_state_flag = BEL_resource_rights_flag
					}
				}
			}
			if = {
				limit = {
					tag = HOL
				}
				HOL = {
					every_state = {
						limit = {
							has_state_flag = HOL_resource_rights_flag
							OR = {
								is_controlled_by = ROOT
								CONTROLLER = { is_subject_of = ROOT }
							}
						}
						PREV = { remove_resource_rights = PREV }
						clr_state_flag = HOL_resource_rights_flag
					}
				}
			}
			if = {
				limit = {
					tag = POR
				}
				POR = {
					every_state = {
						limit = {
							has_state_flag = POR_resource_rights_flag
							OR = {
								is_controlled_by = ROOT
								CONTROLLER = { is_subject_of = ROOT }
							}
						}
						PREV = { remove_resource_rights = PREV }
						clr_state_flag = POR_resource_rights_flag
					}
				}
			}
		}
	}

	on_annex = {
		effect = {
			FROM = {
				if = {
					limit = {
						has_country_flag = trade_fix_ai_strat
					}
					clr_country_flag = trade_fix_ai_strat
					add_offsite_building = { type = dockyard level = -1 }
				}
			}
		}
		effect = {
			ROOT = {
				if = {
					limit = {
						is_ai = no
					}
					every_unit_leader = {
						limit = { has_trait = ai_reassignment }
						remove_trait = { trait = ai_reassignment }
					}
				}
			}
		}
	}

	on_war = {
		effect = {
			if = {
				limit = {
					has_idea = League_of_nations
					OR = {
						AND = {
							has_war_With = ENG
							ENG = { has_idea = League_of_nations }
						}
						AND = {
							has_war_With = FRA
							FRA = { has_idea = League_of_nations }
						}
						AND = {
							has_war_With = FRA
							tag = ENG
						}
						AND = {
							has_war_With = ENG
							tag = FRA
						}
					}
				}
				remove_ideas = League_of_nations
			}
		}
		effect = {
			if = {
				limit = {
					GER = { has_war_with = POL }
					NOT = { SOV = { has_war_With = GER } }
					NOT = { SOV = { has_war_With = POL } }
					NOT = { has_global_flag = invade_poland_question }
					SOV = { has_global_flag = sov_yes_pact }
					SOV = { NOT = { has_global_flag = mr_honored } }
					SOV = { NOT = { has_global_flag = mr_not_honored } }
					OR = {
						POL = { controls_state = 96 }
						POL = { controls_state = 95 }
						POL = { controls_state = 97 }
						POL = { controls_state = 94 }
						POL = { controls_state = 93 }
						POL = { controls_state = 91 }
						POL = { controls_state = 89 }
					}
				}
				set_global_flag = invade_poland_question
				SOV = { country_event = { days = 14 id = sov_armor.819 } }
			}
		}
		effect = {
			if = {
				limit = {
					GER = { has_war_with = SWI }
					GER = { has_completed_focus = GER_swiss_franc_agreement }
				}
				activate_decision = POR_rip_up_the_swiss_franc_agreement
				GER = {
					remove_resource_rights = 180
					remove_ideas = swiss_franc_agreement_GER
				}
			}
		}
		effect = {
			if = {
				limit = {
					tag = USA
					has_completed_focus = USA_selective_service_act
				}
				if = {
					limit = {
						OR = {
							has_idea = disarmed_nation
							has_idea = volunteer_only
						}
					}
					add_ideas = USA_selective_service
				}
			}
		}
	}

	on_civil_war_end = {
		effect = {
			# Give back SOV focus tree to STALIN if they win the civil war.
			if = {
				limit = {
					original_tag = SOV
					has_government = neutrality
					has_focus_tree = generic_focus
				}
				set_politics = { ruling_party = communism elections_allowed = no }
				add_popularity = { ideology = communism popularity = 1.0 }
				load_focus_tree = { tree = soviet_focus keep_completed = no }
				unlock_national_focus = SOV_great_purge
				add_ideas = home_of_revolution
			}
			#End of Belgian Fascist Civil War - Democrats won
			if = {
				limit = {
					original_tag = BEL
					has_government = democratic
					FROM = {
						has_government = fascism
						has_completed_focus = BEL_back_the_rexiste_party
					}
				}
				load_focus_tree = { tree = belgium_focus keep_completed = no }
				unlock_national_focus = BEL_abandon_the_alliance_with_france
			}
			#End of Finnish Communist Civil War - Democrats won
			if = {
				limit = {
					original_tag = FIN
					has_government = democratic
					FROM = {
						has_government = communism
						has_completed_focus = FIN_citizens_of_two_nations
					}
				}
				load_focus_tree = { tree = finland_focus keep_completed = no }
				unlock_national_focus = FIN_citizens_of_one_nation
			}
			#End of SCW fire refugee event
			if = {
				limit = {
					original_tag = SPR
					has_global_flag = scw_over
				}
				FRA = { country_event = fra_armor.818}
			}
		}
	}

	on_government_change = {
		effect = {
			if = {
				limit = {
					has_government = fascism
					NOT = { has_idea = primative_economy }
					NOT = { has_idea = agrarian_society_1 }
					NOT = { has_idea = agrarian_society_2 }
					NOT = { has_idea = agrarian_society_3 }
					NOT = { has_idea = agrarian_society_4 }
					NOT = { has_idea = agrarian_society_5 }
				}
				add_ideas = national_syndicalism
			}
			else_if = {
				limit = {
					has_government = communism
					NOT = { has_idea = primative_economy }
					NOT = { has_idea = agrarian_society_1 }
					NOT = { has_idea = agrarian_society_2 }
					NOT = { has_idea = agrarian_society_3 }
					NOT = { has_idea = agrarian_society_4 }
					NOT = { has_idea = agrarian_society_5 }
				}
				add_ideas = market_socialism
			}
			else_if = {
				limit = {
					has_government = democratic
					NOT = { has_idea = primative_economy }
					NOT = { has_idea = agrarian_society_1 }
					NOT = { has_idea = agrarian_society_2 }
					NOT = { has_idea = agrarian_society_3 }
					NOT = { has_idea = agrarian_society_4 }
					NOT = { has_idea = agrarian_society_5 }
				}
				add_ideas = state_sponsored_economy
			}
			else_if = {
				limit = {
					has_government = neutrality
					NOT = { has_idea = primative_economy }
					NOT = { has_idea = agrarian_society_1 }
					NOT = { has_idea = agrarian_society_2 }
					NOT = { has_idea = agrarian_society_3 }
					NOT = { has_idea = agrarian_society_4 }
					NOT = { has_idea = agrarian_society_5 }
				}
				add_ideas = state_capitalism
			}
			else_if = {
				limit = {
					NOT = { has_idea = primative_economy }
				}
				add_ideas = agrarian_economy
			}
			else = {
				add_ideas = primative_economy
			}
		}
	}

	on_civil_war_end_before_annexation = {
		effect = {
			if = {
				limit = {
					FROM = {
						original_tag = FIN
					}
					has_completed_focus = FIN_march_towards_the_capital
				}
				set_global_flag = fcw_over
			}
		}
		effect = {
			if = { # Fascist victory ICW
				limit = {
					FROM = {
						original_tag = ITA
					}
					NOT = { has_completed_focus = ITA_depose_mussolini }
					ITA_icw_in_progress = yes
					NOT = {
						any_other_country = {
							NOT = {
								tag = ROOT
								tag = FROM
							}
							original_tag = ITA
							exists = yes
						}
					}
				}
				ITF = { country_event = { id = ita_armor.899 } }
				set_global_flag = icw_over
			}
			if = { # Republican victory ICW
				limit = {
					FROM = {
						original_tag = ITA
					}
					has_completed_focus = ITA_depose_mussolini
					ITA_icw_in_progress = yes
					NOT = {
						any_other_country = {
							NOT = {
								tag = ROOT
								tag = FROM
							}
							original_tag = ITA
							exists = yes
						}
					}
				}
				news_event = { id = afo_news.38 days = 1 }
				ITA = { country_event = { id = ita_armor.899 } }
				set_global_flag = icw_over
			}
		}
	}

	#ROOT is new controller #FROM is old controller #FROM.FROM is state ID
	on_state_control_changed = {
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						NOT = {
							is_core_of = ROOT
						}
					}
				}
				FROM.FROM = {
					while_loop_effect = {
						limit = {
							steel_refinery > 0
						}
						disable_steel_mill = yes
					}
					while_loop_effect = {
						limit = {
							hydro_steel_refinery > 0
						}
						disable_hydro_steel_mill = yes
					}
					while_loop_effect = {
						limit = {
							aluminium_refinery > 0
						}
						disable_aluminium_mill = yes
					}
					while_loop_effect = {
						limit = {
							hydro_aluminium_refinery > 0
						}
						disable_hydro_aluminium_mill = yes
					}

				}
			}
		}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						OR = {
							state = 6
							state = 34
							state = 790
							state = 979
							state = 985
						}
					}
				}
				FROM.FROM = {
					remove_dynamic_modifier = { modifier = semi_autonomous_state }
				}
			}
		}
		#effect = {
		#	if = {
		#		limit = {
		#			FROM.FROM = {
		#				has_dynamic_modifier = { modifier = FIN_motti_tactics }
		#			}
		#			ROOT = { NOT = { tag = FIN } }
		#		}
		#		FROM.FROM = {
		#			remove_dynamic_modifier = { modifier = FIN_motti_tactics }
		#		}
		#	}
		#}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = ITL_oil_flag
					}
					ROOT = { NOT = { is_subject_of = ITA } }
				}
				662 = { clr_state_flag = ITL_oil_flag }
				ITA = {
					remove_resource_rights = 662
				}
			}
		}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = ITL_oil_flag_2
					}
					ROOT = { NOT = { is_subject_of = ITA } }
				}
				450 = { clr_state_flag = ITL_oil_flag_2 }
				ITA = {
					remove_resource_rights = 450
				}
			}
		}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = ITE_oil_flag
					}
					ROOT = { NOT = { is_subject_of = ITA } }
				}
				457 = { clr_state_flag = ITE_oil_flag }
				ITA = {
					remove_resource_rights = 457
				}
			}
		}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = RKA_oil_flag
					}
					ROOT = { NOT = { is_subject_of = GER } }
				}
				229 = { clr_state_flag = RKA_oil_flag }
				232 = { clr_state_flag = RKA_oil_flag }
				234 = { clr_state_flag = RKA_oil_flag }
				GER = {
					remove_resource_rights = 229
					remove_resource_rights = 232
					remove_resource_rights = 234
				}
			}
		}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = RNO_iron_flag
					}
					ROOT = { NOT = { is_subject_of = GER } }
				}
				144 = { clr_state_flag = RNO_iron_flag }
				GER = {
					remove_resource_rights = 144
				}
			}
		}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = RSW_iron_flag
					}
					ROOT = { NOT = { is_subject_of = GER } }
				}
				666 = { clr_state_flag = RSW_iron_flag }
				GER = {
					remove_resource_rights = 666
				}
			}
		}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = RFR_iron_flag
					}
					ROOT = { NOT = { is_subject_of = GER } }
				}
				17 = { clr_state_flag = RFR_iron_flag }
				GER = {
					remove_resource_rights = 17
				}
			}
		}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = REN_iron_flag
					}
					ROOT = { NOT = { is_subject_of = GER } }
				}
				859 = { clr_state_flag = REN_iron_flag }
				122 = { clr_state_flag = REN_iron_flag }
				129 = { clr_state_flag = REN_iron_flag }
				130 = { clr_state_flag = REN_iron_flag }
				GER = {
					remove_resource_rights = 859
					remove_resource_rights = 122
					remove_resource_rights = 129
					remove_resource_rights = 130
				}
			}
		}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = MAN_iron_flag
					}
					ROOT = { NOT = { is_subject_of = JAP } }
				}
				716 = { clr_state_flag = MAN_iron_flag }
				JAP = {
					remove_resource_rights = 716
				}
			}
		}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = RNC_iron_flag
					}
					ROOT = { NOT = { is_subject_of = JAP } }
				}
				597 = { clr_state_flag = RNC_iron_flag }
				615 = { clr_state_flag = RNC_iron_flag }
				925 = { clr_state_flag = RNC_iron_flag }
				606 = { clr_state_flag = RNC_iron_flag }
				JAP = {
					remove_resource_rights = 597
					remove_resource_rights = 615
					remove_resource_rights = 925
					remove_resource_rights = 606
				}
			}
		}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = RNC_tungsten_flag
					}
					ROOT = { NOT = { is_subject_of = JAP } }
				}
				595 = { clr_state_flag = RNC_tungsten_flag }
				938 = { clr_state_flag = RNC_tungsten_flag }
				593 = { clr_state_flag = RNC_tungsten_flag }
				592 = { clr_state_flag = RNC_tungsten_flag }
				602 = { clr_state_flag = RNC_tungsten_flag }
				934 = { clr_state_flag = RNC_tungsten_flag }
				599 = { clr_state_flag = RNC_tungsten_flag }
				932 = { clr_state_flag = RNC_tungsten_flag }
				594 = { clr_state_flag = RNC_tungsten_flag }
				JAP = {
					remove_resource_rights = 595
					remove_resource_rights = 938
					remove_resource_rights = 593
					remove_resource_rights = 592
					remove_resource_rights = 602
					remove_resource_rights = 934
					remove_resource_rights = 599
					remove_resource_rights = 932
					remove_resource_rights = 594
				}
			}
		}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = IPM_rubber_flag
					}
					ROOT = { NOT = { is_subject_of = JAP } }
				}
				597 = { clr_state_flag = IPM_rubber_flag }
				615 = { clr_state_flag = IPM_rubber_flag }
				JAP = {
					remove_resource_rights = 597
					remove_resource_rights = 615
				}
			}
		}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = IPI_oil_flag
					}
					ROOT = { NOT = { is_subject_of = JAP } }
				}
				334 = { clr_state_flag = IPI_oil_flag }
				335 = { clr_state_flag = IPI_oil_flag }
				672 = { clr_state_flag = IPI_oil_flag }
				JAP = {
					remove_resource_rights = 334
					remove_resource_rights = 335
					remove_resource_rights = 672
				}
			}
		}
		effect = {
			if = {
				limit = {
					FROM.FROM = {
						has_state_flag = SIA_rubber_flag
					}
					ROOT = { NOT = { is_subject_of = JAP } }
				}
				724 = { clr_state_flag = SIA_rubber_flag }
				JAP = {
					remove_resource_rights = 724
				}
			}
		}
		effect = {
			if = {
				limit = {
					ROOT = { NOT = { tag = RAJ } }
					FROM.FROM = {
						RAJ_has_pakistan_state_modifier = yes
						has_dynamic_modifier = { modifier = marginalized_muslim_community_state }
					}
				}
				FROM.FROM = {
					remove_dynamic_modifier = { modifier = marginalized_muslim_community_state }
					set_state_flag = RAJ_pakistan_state_conquered
				}
			}
		}
		effect = {
			if = {
				limit = {
					ROOT = { NOT = { tag = RAJ } }
					FROM.FROM = {
						RAJ_has_pakistan_state_modifier = yes
						has_dynamic_modifier = { modifier = marginalized_muslim_community_state_happy }
					}
				}
				FROM.FROM = {
					remove_dynamic_modifier = { modifier = marginalized_muslim_community_state_happy }
					set_state_flag = RAJ_pakistan_state_conquered
				}
			}
		}
		effect = {
			if = {
				limit = {
					ROOT = { NOT = { tag = RAJ } }
					FROM.FROM = {
						RAJ_has_pakistan_state_modifier = yes
						has_dynamic_modifier = { modifier = marginalized_muslim_community_state_angry }
					}
				}
				FROM.FROM = {
					remove_dynamic_modifier = { modifier = marginalized_muslim_community_state_angry }
					set_state_flag = RAJ_pakistan_state_conquered
				}
			}
		}
		effect = {
			if = {
				limit = {
					ROOT = { NOT = { tag = RAJ } }
					FROM.FROM = {
						RAJ_has_inc_state_modifier = yes
						has_dynamic_modifier = { modifier = indian_national_congress_state }
					}
				}
				FROM.FROM = {
					remove_dynamic_modifier = { modifier = indian_national_congress_state }
					set_state_flag = RAJ_indian_state_conquered
				}
			}
		}
		effect = {
			if = {
				limit = {
					ROOT = { NOT = { tag = RAJ } }
					FROM.FROM = {
						RAJ_has_princley_state_modifier = yes
						has_dynamic_modifier = { modifier = princley_state }
					}
				}
				FROM.FROM = {
					remove_dynamic_modifier = { modifier = princley_state }
					set_state_flag = RAJ_indian_state_conquered
				}
			}
		}
		effect = {
			if = {
				limit = {
					ROOT = { NOT = { tag = RAJ } }
					FROM.FROM = {
						RAJ_has_princley_state_modifier = yes
						has_dynamic_modifier = { modifier = princley_state_happy }
					}
				}
				FROM.FROM = {
					remove_dynamic_modifier = { modifier = princley_state_happy }
					set_state_flag = RAJ_indian_state_conquered
				}
			}
		}
		effect = {
			if = {
				limit = {
					ROOT = { NOT = { tag = RAJ } }
					FROM.FROM = {
						RAJ_has_hm_state_modifier = yes
						has_dynamic_modifier = { modifier = hm_state }
					}
				}
				FROM.FROM = {
					remove_dynamic_modifier = { modifier = hm_state }
					set_state_flag = RAJ_indian_state_conquered
				}
			}
		}
		effect = {
			if = {
				limit = {
					TAG = GER
					GER = { has_government = fascism }
					has_war_with = DEN
					date < 1942.1.1
					DEN = { has_government = democratic }
					DEN = { has_capitulated = no }
					OR = {
						NOT = {
							871 = { is_fully_controlled_by = DEN }
						}
						NOT = {
							99 = { is_fully_controlled_by = DEN }
						}
						NOT = {
							37 = { is_fully_controlled_by = DEN }
						}
					}
					# 37 = { is_owned_by = DEN }
					# 37 = { is_controlled_by = GER }
					58 = { is_controlled_by = GER }
					803 = { is_controlled_by = GER }
					59 = { is_controlled_by = GER }
					61 = { is_controlled_by = GER }
					56 = { is_controlled_by = GER }
					62 = { is_controlled_by = GER }
					OR = {
						AND = {
							GER = { has_war_with = POL }
							POL = { has_capitulated = yes }
						}
						AND = {
							GER = { has_war_with = CZE }
							CZE = { has_capitulated = yes }
						}
						AND = {
							GER = { has_war_with = HOL }
							HOL = { has_capitulated = yes }
						}
						AND = {
							GER = { has_war_with = BEL }
							BEL = { has_capitulated = yes }
						}
						AND = {
							GER = { has_war_with = ROM }
							ROM = { has_capitulated = yes }
						}
						AND = {
							GER = { has_war_with = FRA }
							FRA = { has_capitulated = yes }
						}
						AND = {
							GER = { has_war_with = ENG }
							ENG = { has_capitulated = yes }
						}
						AND = {
							GER = { has_war_with = NOR }
							NOR = { has_capitulated = yes }
						}
						AND = {
							GER = { has_war_with = SWE }
							SWE = { has_capitulated = yes }
						}
					}
				}
				DEN = { country_event = { id = den_armor.5 } }
			}
			if = {
				limit = {
					TAG = GER
					GER = { has_government = fascism }
					has_war_with = FRA
					date < 1942.1.1
					FRA = { has_idea = FRA_disjointed_government }
					FRA = { has_capitulated = no }
					OR = {
						785 = { is_controlled_by = GER }
						16 = { is_controlled_by = GER }
					}
					OR = {
						29 = { is_controlled_by = GER }
						29 = { is_controlled_by = RBE }
					}
					OR = {
						18 = { is_controlled_by = GER }
						785 = { is_fully_controlled_by = GER }
					}
					855 = { is_controlled_by = FRA }
					OR = {
						NOT = { FRA = { is_in_faction_with = BEL } }
						AND = {
							FRA = { is_in_faction_with = BEL }
							BEL = { has_capitulated = yes }
						}
					}
				}
				FRA = { country_event = { id = fra_armor.804 } }
			}
		}
		effect = {
			if = {
				limit = {
					SOV = { has_government = communism }
					ENG = { has_government = democratic }
					SOV = { has_war_with = PER }
					ENG = { has_war_with = PER }
					PER = { surrender_progress > 0.01 }
					NOT = { ENG = { has_war_with = SOV } }
				}
				PER = { country_event = { id = per_armor.1 days = 14 } }
			}
		}
	}

	on_government_exiled = {
		effect = {
			add_ideas = exiled_economy
		}
	}

	on_exile_government_reinstated = {
		effect = {
			if = {
				limit = {
					has_idea = exiled_economy
				}
				add_ideas = civilian_economy
			}
		}
	}

	on_weekly = {
		effect = {
			if = {
				limit = {
					is_ai = yes
					not = {has_country_flag = trade_fix_ai_strat}
				}
				if = {
					limit = {
						not = {has_tech = trade_fix_tech}
					}
					set_technology = { trade_fix_tech = 1 popup = no }
				}
				set_country_flag = trade_fix_ai_strat
				add_equipment_production = {
					equipment = {
						type = trade_fix_equipment_0
					}
					requested_factories = 1
					progress = 0.65
					amount = 1
				}
				add_offsite_building = { type = dockyard level = 1 }
			}
		}
	}
	on_weekly_SOV = {
		effect = {
			if = {
				limit = { has_variable = greatest_airforce_tac }

				set_variable = { sov_cur_tac = num_deployed_planes_with_type@tac_bomber_equipment }
				set_variable = { greatest_airforce_tac = sov_cur_tac }

				set_variable = { sov_cur_str = num_deployed_planes_with_type@strike_bomber_equipment }
				add_to_variable = { greatest_airforce_tac = sov_cur_str }
			}
		}
	}
	on_weekly_FRA = {
		effect = {
			if = {
				limit = {
					OR = {
						has_active_mission = FRA_modernize_airforce_mission
						NOT = { has_completed_focus = FRA_the_arsenal_de_laeronautique}
					}
				}

				set_variable = { french_figthers = num_deployed_planes_with_type@fighter_equipment}
				add_to_variable = {french_figthers = num_deployed_planes_with_type@fighter_multirole_equipment }

				set_variable = {french_bombers = num_deployed_planes_with_type@tac_bomber_equipment}
				add_to_variable = { french_bombers = num_deployed_planes_with_type@strat_bomber_equipment}

				set_variable = { fra_cur_atac = num_deployed_planes_with_type@attacker_equipment }
				set_variable = { french_attackers = fra_cur_atac }

				set_variable = { french_heavy_plane = num_deployed_planes_with_type@attacker_equipment@heavy_fighter_equipment }
				add_to_variable = { french_heavy_plane = fra_cur_atac }

				set_variable = { fra_cur_cas = num_deployed_planes_with_type@CAS_equipment }
				add_to_variable = { french_attackers = fra_cur_cas }
			}
		}
	}
	on_daily_FRA = {
		effect = {
			if = {
				limit = {
					has_country_flag = steel_contract_ongoing
				}

				20 = {
					set_variable = { steel_mills_now = building_level@steel_refinery}
					add_to_variable = { steel_mills_now = building_level@steel_refinery_inactive}
				}
				27 = {
					set_variable = { steel_mills_now = building_level@steel_refinery}
					add_to_variable = { steel_mills_now = building_level@steel_refinery_inactive}
				}
			}
		}
		effect = {
			if = {
				limit = { has_variable = promote_tanks_mission }

				set_variable = { fra_cur_lt = num_equipment_in_armies@medium_tank_chassis }
				set_variable = { promote_tanks_mission = fra_cur_lt }

				set_variable = { fra_cur_mt = num_equipment_in_armies@heavy_tank_chassis }
				set_variable = { promote_tanks_mission = fra_cur_mt }
			}
		}
	}
	on_weekly_GER = {
		effect = {
			if = {
				limit = { has_variable = creation_of_the_panzer_core_tanks }

				set_variable = { ger_cur_lt = num_equipment_in_armies@light_tank_chassis }
				set_variable = { creation_of_the_panzer_core_tanks = ger_cur_lt }

				set_variable = { ger_cur_mt = num_equipment_in_armies@medium_tank_chassis }
				add_to_variable = { creation_of_the_panzer_core_tanks = ger_cur_mt }

				set_variable = { ger_cur_ist = num_equipment_in_armies@medium_tank_infantry_support_chassis }
				add_to_variable = { creation_of_the_panzer_core_tanks = ger_cur_ist }
			}
		}
	}
	on_weekly_ENG = {
		effect = {
			if = {
				limit = { has_variable = creation_of_the_armoured_corps_tanks }

				set_variable = { eng_cur_ht = num_equipment_in_armies@heavy_tank_chassis }
				set_variable = { creation_of_the_armoured_corps_tanks = eng_cur_ht }

				set_variable = { eng_cur_mt = num_equipment_in_armies@medium_tank_chassis }
				add_to_variable = { creation_of_the_armoured_corps_tanks = eng_cur_mt }

				set_variable = { eng_cur_hts = num_equipment_in_armies@heavy_tank_support_chassis }
				add_to_variable = { creation_of_the_armoured_corps_tanks = eng_cur_hts }
			}
		}
	}
	on_weekly_ITA = {
		effect = {
			if = {
				limit = { has_variable = modernization_of_the_Regio_esercito_tanks }

				set_variable = { ita_cur_lt = num_equipment_in_armies@light_tank_chassis }
				set_variable = { modernization_of_the_Regio_esercito_tanks = ita_cur_lt }

				set_variable = { ita_cur_mt = num_equipment_in_armies@medium_tank_chassis }
				add_to_variable = { modernization_of_the_Regio_esercito_tanks = ita_cur_mt }
			}
		}
		effect = {
			if = {
				limit = { has_variable = ITA_modernization_of_the_regio_aeronautica }

				set_variable = { ita_cur_tac = num_deployed_planes_with_type@tac_bomber_equipment }
				set_variable = { ITA_modernization_of_the_regio_aeronautica = ita_cur_tac }

				set_variable = { ita_cur_str = num_deployed_planes_with_type@strike_bomber_equipment }
				add_to_variable = { ITA_modernization_of_the_regio_aeronautica = ita_cur_str }
			}
		}
	}
	on_weekly_USA = {
		effect = {
			if = {
				limit = {
					has_idea = USA_FY42_plan
				}
				log = "I'm working"
				set_variable = {
					new_total_light_ships = num_ships_with_type@destroyer
				}
				add_to_variable = {
					new_total_light_ships = num_ships_with_type@frigate
				}
				set_variable = {
					total_light_ships = new_total_light_ships
				}
				if = {
					limit = {
						has_navy_size = {
							size > fy_cv
							archetype = ship_hull_carrier
						}
					}
					set_country_flag = fy44_cv_done
				}
				if = {
					limit = {
						has_navy_size = {
							size > fy_cvl
							archetype = ship_hull_light_carrier
						}
					}
					set_country_flag = fy44_cvl_done
				}
				if = {
					limit = {
						has_navy_size = {
							size > fy_ca
							archetype = ship_hull_heavy_cruiser
						}
					}
					set_country_flag = fy44_ca_done
				}
				if = {
					limit = {
						has_navy_size = {
							size > fy_cl
							archetype = ship_hull_cruiser
						}
					}
					set_country_flag = fy44_cl_done
				}
				if = {
					limit = {
						check_variable = {
							total_light_ships > required_light_ships
						}
					}
					set_country_flag = fy44_light_done
				}
				if = {
					limit = {
						has_navy_size = {
							size > fy_sc
							archetype = ship_hull_cruiser_submarine
						}
					}
					set_country_flag = fy44_sc_done
				}
			}
		}
		effect = {
			if = {
				limit = {
					has_idea = USA_FY40_plan
				}
				if = {
					limit = {
						has_navy_size = {
							size > fy_cv
							archetype = ship_hull_carrier
						}
					}
					set_country_flag = fy40_cv_done
				}
				if = {
					limit = {
						has_navy_size = {
							size > fy_bb
							archetype = ship_hull_heavy_battleship
						}
					}
					set_country_flag = fy40_bb_done
				}
				if = {
					limit = {
						has_navy_size = {
							size > fy_ca
							archetype = ship_hull_heavy_cruiser
						}
					}
					set_country_flag = fy40_ca_done
				}
				if = {
					limit = {
						has_navy_size = {
							size > fy_cl
							archetype = ship_hull_cruiser
						}
					}
					set_country_flag = fy40_cl_done
				}
				if = {
					limit = {
						has_navy_size = {
							size > fy_dd
							archetype = ship_hull_light
						}
					}
					set_country_flag = fy40_dd_done
				}
				if = {
					limit = {
						has_navy_size = {
							size > fy_sc
							archetype = ship_hull_cruiser_submarine
						}
					}
					set_country_flag = fy40_sc_done
				}
			}
		}
	}

	on_declare_war = {
		#effect = {
		#	if = {
		#		limit = {
		#			FROM = {
		#				tag = SOV
		#				has_war_with = FIN
		#				NOT = {
		#					any_enemy_country = {
		#						is_major = yes
		#					}
		#				}
		#			}
		#			OR = {
		#				FIN = { is_in_faction = no }
		#				FIN = { is_faction_leader = yes }
		#			}
		#			146 = { is_owned_by = FIN }
		#		}
		#	}
		#	add_timed_idea = {
		#		idea = SOV_winter_war_offensive
		#		days = 240
		#	}
		#}
		effect = {
			if = {
				limit = {
					FROM = {
						tag = USA
						has_country_flag = end_mobilization
					}
				}
				FROM = {
					clr_country_flag = end_mobilization
				}
			}
			else_if = {
				limit = {
					tag = USA
					has_country_flag = end_mobilization
				}
				clr_country_flag = end_mobilization
			}
		}
	}

	on_war_relation_added = {
		effect = {
			if = {
				limit = {
					tag = ENG
					is_ai = no
					any_enemy_country = {
						is_ai = no
					}
					NOT = { has_country_flag = ENG_colonies_annexed }
				}
				hidden_effect = {
					set_country_flag = ENG_colonies_annexed
				}
				annex_country = { target = UKO }
				annex_country = { target = UKE }
				annex_country = { target = UKN }
				annex_country = { target = UKT }
				annex_country = { target = UKM }
				add_equipment_to_stockpile = { type = eng_inf_1 amount = 11800 producer = ENG }
				add_equipment_to_stockpile = { type = support_equipment_1 amount = 700 producer = ENG }
			}
			if = {
				limit = {
					tag = ITA
					is_ai = no
					any_enemy_country = {
						is_ai = no
					}
					NOT = { has_country_flag = ITA_colonies_annexed }
				}
				hidden_effect = {
					set_country_flag = ITA_colonies_annexed
				}
				ITL = {
					every_unit_leader = {
						set_nationality = ITA
					}
				}
				annex_country = { target = ITL transfer_troops = yes }
				annex_country = { target = ITS transfer_troops = yes }
				add_equipment_to_stockpile = { type = ita_inf_0 amount = 1900 producer = ITL }
			}
		}
	}
}